<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minecraft Real Ping Monitor</title>

<!-- Minecraft Font -->
<link href="https://fonts.cdnfonts.com/css/minecraft-4" rel="stylesheet">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Leaflet Map -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
body{
  margin:0;
  height:100vh;
  background:url("dfr.jpg") no-repeat center center fixed;
  background-size:cover;
  font-family:'Minecraft', sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
}
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.65);
}
.card{
  position:relative;
  z-index:2;
  width:95%;
  max-width:450px;
  backdrop-filter:blur(16px);
  background:rgba(10,10,20,.75);
  border-radius:22px;
  padding:18px;
  color:#e5e7eb;
  box-shadow:0 0 30px #00ffff66;
}
h1{
  text-align:center;
  color:#00ffff;
  text-shadow:0 0 10px #00ffff;
}
input,select,button{
  width:100%;
  padding:10px;
  margin:6px 0;
  border:none;
  border-radius:10px;
  font-family:inherit;
}
input,select{
  background:#111827;
  color:white;
}
button{
  background:#00ffff;
  color:black;
  font-weight:bold;
}
.good{color:#22c55e}
.medium{color:#facc15}
.bad{color:#ef4444}
.neon{text-shadow:0 0 8px currentColor}

#map{
  height:150px;
  border-radius:12px;
  margin-top:10px;
}
canvas{
  margin-top:10px;
}
</style>
</head>

<body>
<div class="overlay"></div>

<div class="card">
<h1>Minecraft Ping</h1>

<input id="ip" placeholder="Server IP">
<input id="port" placeholder="Port (25565 / 19132)">

<select id="type">
  <option value="java">Java</option>
  <option value="bedrock">Bedrock</option>
  <option value="geyser">Geyser</option>
  <option value="other">Other</option>
</select>

<button onclick="checkPing()">Check Ping</button>

<div>
  Ping: <span id="ping">--</span> ms<br>
  Min: <span id="min">--</span> ms |
  Max: <span id="max">--</span> ms<br>
  Gameplay: <span id="quality">--</span>
</div>

<canvas id="chart"></canvas>
<div id="map"></div>
</div>

<audio id="pingSound" src="sounds/alert.mp3" preload="auto"></audio>

<script>
let minPing=Infinity,maxPing=0;
let dataArr=[];
const sound=document.getElementById("pingSound");

const ctx=document.getElementById("chart");
const chart=new Chart(ctx,{
  type:"line",
  data:{
    labels:[],
    datasets:[{
      label:"Ping (ms)",
      data:[],
      borderWidth:2,
      tension:.3
    }]
  },
  options:{responsive:true}
});

async function checkPing(){
  const ip=ipInput.value;
  const port=portInput.value;
  const type=typeSelect.value;

  const res=await fetch(
    `https://YOUR-BACKEND-URL/ping?ip=${ip}&port=${port}&type=${type}`
  );
  const data=await res.json();

  if(!data.online){
    quality.innerText="SERVER OFFLINE";
    return;
  }

  const ping=data.ping;
  document.getElementById("ping").innerText=ping;

  minPing=Math.min(minPing,ping);
  maxPing=Math.max(maxPing,ping);
  min.innerText=minPing;
  max.innerText=maxPing;

  if(ping<=100){
    quality.innerText="GOOD";
    quality.className="good neon";
  }else if(ping<=200){
    quality.innerText="MEDIUM";
    quality.className="medium neon";
  }else{
    quality.innerText="BAD";
    quality.className="bad neon";
    sound.play();
  }

  dataArr.push(ping);
  chart.data.labels.push("");
  chart.data.datasets[0].data=dataArr;
  chart.update();
}

/* Location Map */
const map=L.map('map').setView([0,0],2);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

fetch("https://ipapi.co/json/")
.then(r=>r.json())
.then(l=>{
  map.setView([l.latitude,l.longitude],10);
  L.marker([l.latitude,l.longitude]).addTo(map);
});
</script>
</body>
</html>
