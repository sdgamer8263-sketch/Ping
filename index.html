<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minecraft Ping</title>
<link href="https://fonts.cdnfonts.com/css/minecraft-4" rel="stylesheet">
<style>
*{box-sizing:border-box;font-family:'Minecraft',sans-serif}
body{
  margin:0;min-height:100vh;
  background:
    linear-gradient(rgba(0,0,0,.75),rgba(0,0,0,.75)),
    url("beaa776788318ffa9adf475282e18bb5.gif") center/cover no-repeat fixed;
  display:flex;align-items:center;justify-content:center;color:#0ff
}
.card{
  width:95%;max-width:420px;padding:20px;
  background:rgba(0,0,0,.45);backdrop-filter:blur(16px);
  border-radius:20px;box-shadow:0 0 30px #0ff
}
h1{text-align:center;margin:0 0 10px}
input,select,button{
  width:100%;padding:12px;margin:8px 0;border-radius:10px;border:none
}
input,select{background:#111;color:#0ff}
button{background:#0ff;color:#000;font-weight:bold}
button:active{transform:scale(.97)}
.result{text-align:center;margin-top:6px}
.good{color:#0f0}.medium{color:#ff0}.bad{color:#f33}
canvas{margin-top:10px;width:100%}
.small{text-align:center;font-size:12px;opacity:.8}
</style>
</head>
<body>

<div class="card">
  <h1>MC PING</h1>

  <input id="ip" placeholder="Server IP (play.hypixel.net)">
  <input id="port" value="25565">

  <select id="type">
    <option value="java">Java</option>
    <option value="bedrock">Bedrock</option>
    <option value="geyser">Geyser</option>
    <option value="other">Other</option>
  </select>

  <button onclick="checkPing()">Check Ping</button>

  <div class="result" id="status">Ready</div>
  <div class="result" id="ping"></div>
  <div class="result" id="quality"></div>

  <canvas id="graph" height="80"></canvas>
  <div class="small">Tip: First click may wake server</div>
</div>

<audio id="alertSound" src="sounds/alert.mp3"></audio>

<script>
const API="https://ping-yies.onrender.com/ping";
const c=document.getElementById("graph"),x=c.getContext("2d");
let hist=[],waking=false;

function checkPing(){
  const ip=document.getElementById("ip").value.trim();
  const port=document.getElementById("port").value.trim()||"25565";
  const type=document.getElementById("type").value;
  if(!ip){set("Enter server IP ❌");return}

  set("Checking...");
  fetch(`${API}?ip=${ip}&port=${port}&type=${type}`)
  .then(r=>r.json())
  .then(d=>{
    if(!d.online){set("Server Offline ❌");return}
    waking=false;
    const p=d.ping;
    hist.push(p); if(hist.length>20) hist.shift();
    document.getElementById("ping").innerText=`Ping: ${p} ms`;

    let t="GOOD",cls="good";
    if(p>200){t="BAD";cls="bad";sound()}
    else if(p>120){t="MEDIUM";cls="medium"}
    document.getElementById("quality").innerHTML=`<span class="${cls}">${t}</span>`;
    set("Online ✅");
    draw();
  })
  .catch(()=>{
    if(!waking){
      waking=true;
      set("Waking server… tap again ⏳");
    }
  });
}

function set(s){document.getElementById("status").innerText=s}
function sound(){const a=document.getElementById("alertSound");a.currentTime=0;a.play()}
function draw(){
  c.width=c.clientWidth;x.clearRect(0,0,c.width,c.height);
  x.beginPath();x.strokeStyle="#0ff";
  hist.forEach((p,i)=>{
    const xx=i*(c.width/20),yy=c.height-(p/300*c.height);
    i?x.lineTo(xx,yy):x.moveTo(xx,yy)
  });x.stroke();
}
</script>
</body>
</html>
